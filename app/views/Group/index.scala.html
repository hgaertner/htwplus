@(approvedGroups: List[Group], unapprovedGroups: List[GroupAccount], groupForm: Form[Group])
@import helper._
@import models.enums._

@main("Gruppen") {

<!-- createNewGroupModal -->
<div id="createNewGroupModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="createNewGroupModalLabel" aria-hidden="true">@views.html.Group.snippets.addModal(groupForm)</div>
<!-- Ende createNewGroupModal -->

<!-- searchModal -->
<div id="searchModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">@views.html.Group.snippets.searchModal(null)</div>
<!-- Ende searchModal -->

<!-- Start infoModal -->
@for(group <- approvedGroups) {
<div id="infoModal@group.id" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="infoModalLabel" aria-hidden="false">@views.html.Group.snippets.infoModal(group)</div>
}
<!-- Ende infoModal -->

<!-- Start editModal -->
<div id="editModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="infoModalLabel" aria-hidden="true">
	<div class="loading-modal">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
			<h3 id="editModalLabel">Gruppe bearbeiten</h3>
		</div>
		<div class="modal-body">
			<div class="loading"></div>
			Wird geladen
		</div>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Schließen</button>
		</div>
	</div>
</div>
<!-- Ende editModal -->

<!-- Start confirmDeleteGroupModal -->
@for(group <- approvedGroups) {
<div id="confirmDeleteGroup@group.id" class="modal hide fade" tabindex="-1" role="dialog">@views.html.Group.snippets.deleteGroupModal(group)</div>
}
<!-- End confirmDeleteGroupModal -->

@defining(Component.currentAccount()) { user =>
<h2><span rel="tooltip" data-original-title="Hier findest du den aktuellen Status deiner Gruppen-Anfragen." data-delay="500">
Offene Anfragen</span></h2>
@if(!unapprovedGroups.isEmpty){
<table class="table table-hover">
	<colgroup>
		<col width="30%">
		<col width="30%">
		<col width="25%">
		<col width="15%">
	</colgroup>
	<thead>
		<tr>
			<th>Gruppenname</th>
			<th>Von</th>
			<th>Status</th>
			<th>Optionen</th>
		</tr>
	</thead>

	<tbody>
		@for(accountGroup <- unapprovedGroups) {
		<tr>
			@if(accountGroup.account.equals(user)) {
			<td><a href="@routes.GroupController.view(accountGroup.group.id)">@accountGroup.group.title</a></td>
			<td><a href="@routes.ProfileController.view(accountGroup.account.id)">Dir</a></td>
			<td>@if(accountGroup.linkType.equals(models.enums.LinkType.reject)) {abgelehnt} else {in Bearabeitung}</td>
			<td><a href="@routes.GroupController.removeMember(accountGroup.group.id, accountGroup.account.id)" rel="tooltip" data-original-title="@if(accountGroup.linkType.equals(models.enums.LinkType.reject)) {löschen} else {Anfrage zurückziehen}"><i class="icon-remove"></i></a></td>
			} else {
			<td><a href="@routes.GroupController.view(accountGroup.group.id)">@accountGroup.group.title</a></td>
			<td>@views.html.snippets.userLink(accountGroup.account)</td>
			<td>zu bearbeiten</td>
			<td><a href="@routes.GroupController.acceptRequest(accountGroup.group.id, accountGroup.account.id)" rel="tooltip" data-original-title="Anfrage akzeptieren"><i class="icon-ok"></i></a>
			    <a href="@routes.GroupController.declineRequest(accountGroup.group.id, accountGroup.account.id)" rel="tooltip" data-original-title="Anfrage zurückweisen"><i class="icon-remove"></i></a></td>
			}
		</tr>
		}
	</tbody>
</table>
} else {
<p><i>Keine Anfragen vorhanden.</i></p>
}
<hr />
<br />

<h2>
	<span rel="tooltip" data-original-title="Hier findest du alle Gruppen die du gegründet hast oder denen du beigetreten bist." data-delay="500">Meine Gruppen</span>
	<div class="btn-group">
		<a href="#createNewGroupModal" role="button" class="btn" data-toggle="modal" rel="tooltip" data-original-title="neue Gruppe erstellen"><i class="icon-plus"></i></a>
		<a href="#searchModal" role="button" class="btn last" data-toggle="modal" rel="tooltip" data-original-title="Gruppe suchen"><i class="icon-search"></i></a>
	</div>
</h2>
@if(!approvedGroups.isEmpty){
<table class="table table-hover">
	<colgroup>
		<col width="85%">
		<col width="15%">
	</colgroup>
	<thead>
		<tr>
			<th>Gruppenname</th>
			<th>Optionen</th>
		</tr>
	</thead>
	<tbody>
		@for(group <- approvedGroups) {
		<tr>
			<td>
			@if(group.groupType.equals(GroupType.open)) { <i class="icon-globe"></i>}
			@if(group.groupType.equals(GroupType.close)) { <i class="icon-lock"></i>}
			@if(group.groupType.equals(GroupType.course)) { <i class="icon-briefcase"></i>}
				<a href="@routes.GroupController.view(group.id)">@if(group.owner.id == user.id) {
					<b> @group.title</b></a> <small>(gegründet)</small>} else { @group.title</a>}
			</td>
			<td><a href="#infoModal@group.id" rel="tooltip" data-original-title="Gruppeninfo" data-toggle="modal"><i class="icon-info-sign"></i></a>
				@if(Secured.isOwnerOfGroup(group, user)) {
					<a href="#confirmDeleteGroup@group.id" rel="tooltip" data-toggle="modal" data-original-title="Gruppe löschen"><i class="icon-trash"></i></a>
				} else {
					<a href="@routes.GroupController.removeMember(group.id, user.id)" rel="tooltip" data-toggle="modal" data-original-title="Gruppe verlassen"><i class="icon-remove"></i></a>
				}
			</td>
		</tr>
		}
	</tbody>
</table>
} else {
<p><i>Noch keinen Gruppen beigetreten.</i></p>
}
}
}
